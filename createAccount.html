<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Account</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
       form{
        box-shadow: 0px 0px 10px gray;
        width: 500px;
        margin:auto;
        padding: 5px;
       }
       .name, .age-dob,.can-sub{
        display: flex;
        gap:10px;
       }
       ul>li{
        font-size: 15px;
       }

    </style>
</head>
<body>
    <section class="container">
        <form action="" class="account p-md-3">
            <h1 class="text-center mb-4 font-monospace">Create Account</h1>
           <div class="name"> 
            <div class="form-floating mb-3 w-100">
                    <input type="text" class="form-control" id="fname" placeholder="Enter your First Name" required>
                    <label for="fname">First Name</label>
                </div>
                <div class="form-floating mb-3 w-100">
                    <input type="text" class="form-control" id="lname" placeholder="Enter your Last Name" required>
                    <label for="lname">Last Name</label>
                </div>
            </div>
                
            <div class="age-dob">
                <div class="form-floating mb-3 w-100">
                    <input type="number" class="form-control" id="age" placeholder="Enter your Age" required>
                    <label for="age">Age</label>
                </div>
                <div class="form-floating mb-3 w-100">
                    <input type="date" class="form-control" id="dob" placeholder="Enter your DOB" required>
                    <label for="dob">DOB</label>
                </div>
            </div>
            <div class="form-floating mb-3">
                    <input type="email" class="form-control" id="email" placeholder="name@example.com" required>
                    <label for="email">Email address</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="password" class="form-control" id="password" placeholder="Password"  onkeyup="PasswordChecker()" required>
                    <label for="password">Password</label>
                    <div>
                        <ul>
                            <li id="onecapletter">Contains at least one Capital letter.</li>
                            <li id="onesmletter">Contains at least one Small letter.</li>
                            <li id="onenumber">Contains at least one number.</li>
                            <li id="onespecialchar">Contains at least one special character</li>
                            <li id="totalchar">Minimum 8 characters long.</li>
                        </ul>
                    </div>
                </div>
                <div class="form-floating mb-2">
                    <input type="password" class="form-control" id="cpassword" placeholder="Password" required>
                    <label for="cpassword">Confirm Password</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="tel" class="form-control" id="phonenumber" placeholder="phonenumber" required>
                    <label for="phonenumber">Enter Your Phone number with (+country code)</label>
                </div>
                <div>
                    <label for="gender">Gender: </label>
                    <input type="radio" value="Male" name="gender"> <label for="gender">Male</label>
                    <input type="radio" value="Female" name="gender"> <label for="gender">Female</label>
                </div>
                <div class="can-sub mt-md-3">
                    <button class="btn btn-outline-danger w-100">Cancel</button>
                    <button class="btn btn-outline-success w-100">Submit</button>
                </div>
            
        </form>
    </section>
    <script>

        document.querySelector("form").addEventListener("submit", login);
        function PasswordChecker(){
            let password = document.getElementById("password").value;

            let lowercase_error = document.getElementById("onesmletter");
            let uppercase_error = document.getElementById("onecapletter");
            let numbers_error = document.getElementById("onenumber");
            let special_symbol_error = document.getElementById("onespecialchar");
            let length_error = document.getElementById("totalchar");

            if(password.length === 0){
                [uppercase_error, lowercase_error, numbers_error, special_symbol_error, length_error].forEach(el => el.style.color = "red");
                return;
            }

            uppercase_error.style.color = /(?=.*[A-Z])/.test(password) ? "green" : "red";
            lowercase_error.style.color = /(?=.*[a-z])/.test(password) ? "green" : "red";
            numbers_error.style.color   = /(?=.*\d)/.test(password) ? "green" : "red";
            special_symbol_error.style.color = /(?=.*[@&#$%^&*])/.test(password) ? "green" : "red";
            length_error.style.color = /.{8,}/.test(password) ? "green" : "red";
        }

        async function login(e){
            e.preventDefault();
            var gender=document.getElementsByName("gender");
            var selected;
            for(let i=0;i<gender.length;i++){
                if(gender[i].checked){
                    selected=gender[i].value;
                }
            }
           try {
        const res = await axios.post("https://loginpage-backend-6jdy.onrender.com/create/account", {
            FirstName: document.getElementById("fname").value,
            LastName: document.getElementById("lname").value,
            Age: document.getElementById("age").value,
            DOB:document.getElementById("dob").value,
            Email: document.getElementById("email").value,
            Password:document.getElementById("password").value,
            ConfirmPassword:document.getElementById("cpassword").value,
            PhoneNumber: document.getElementById("phonenumber").value,
            Gender:selected
        });

        alert(res.data.message);
        document.querySelector("form").reset();
        window.location.href="./index.html"

    } catch (error) {
        alert(error.response ? error.response.data.message : error.message);
    }
}

    </script>
</body>
</html>